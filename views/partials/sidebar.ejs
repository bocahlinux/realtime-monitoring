<!-- Sidebar -->
<aside
  id="sidebar"
  class="
    hidden md:flex
    flex-col
    fixed md:sticky
    top-[60px]
    left-0
    h-[calc(100vh-60px)]
    w-64
    bg-white dark:bg-govnavy dark:text-slate-100
    shadow-lg
    transition-all duration-300
    overflow-y-auto
    z-40
  "
>
  <div class="p-2"></div>

  <!-- MENU -->
  <nav class="mt-4 flex-1 overflow-y-auto">
    <ul class="space-y-1 text-sm">
      <li>
        <a
          href="/"
          class="flex items-center gap-3 px-5 py-2 rounded-md
                 text-gray-700 hover:bg-blue-100 hover:text-blue-700
                 <%= activePage === 'dashboard' ? 'sidebar-active bg-blue-100 text-blue-700 font-semibold' : '' %>"
        >
          <span class="sidebar-icon text-xl">ğŸ </span>
          <span class="sidebar-text">Dashboard</span>
        </a>
      </li>

      <li>
        <a
          href="/laporan/realtime"
          class="flex items-center gap-3 px-5 py-2 rounded-md
                 text-gray-700 hover:bg-blue-100 hover:text-blue-700
                 <%= activePage === 'realtime' ? 'sidebar-active bg-blue-100 text-blue-700 font-semibold' : '' %>"
        >
          <span class="sidebar-icon text-xl">ğŸ“Š</span>
          <span class="sidebar-text">Laporan Realtime</span>
        </a>
      </li>

      <li>
        <a
          href="/laporan/rekap-bulanan"
          class="flex items-center gap-3 px-5 py-2 rounded-md
                 text-gray-700 hover:bg-blue-100 hover:text-blue-700
                 <%= activePage === 'rekap-bulanan' ? 'sidebar-active bg-blue-100 text-blue-700 font-semibold' : '' %>"
        >
          <span class="sidebar-icon text-xl">ğŸ“Š</span>
          <span class="sidebar-text">Laporan Rekap</span>
        </a>
      </li>

      <li>
        <a
          href="/transaksi/input-pap"
          class="flex items-center gap-3 px-5 py-2 rounded-md
                 text-gray-700 hover:bg-blue-100 hover:text-blue-700
                 <%= activePage === 'transaksi-pap' ? 'sidebar-active bg-blue-100 text-blue-700 font-semibold' : '' %>"
        >
          <span class="sidebar-icon text-xl">ğŸ“˜</span>
          <span class="sidebar-text">Transaksi PAP</span>
        </a>
      </li>

      <li>
        <a
          href="/transaksi/input-pab"
          class="flex items-center gap-3 px-5 py-2 rounded-md
                 text-gray-700 hover:bg-blue-100 hover:text-blue-700
                 <%= activePage === 'transaksi-pab' ? 'sidebar-active bg-blue-100 text-blue-700 font-semibold' : '' %>"
        >
          <span class="sidebar-icon text-xl">ğŸ“—</span>
          <span class="sidebar-text">Transaksi PAB</span>
        </a>
      </li>

      <% if (user && user.level === 'superadmin') { %>
      <li>
        <a
          href="/superadmin/users"
          class="flex items-center gap-3 px-5 py-2 rounded-md
                text-gray-700 hover:bg-blue-100 hover:text-blue-700
                <%= activePage === 'superadmin-users' ? 'sidebar-active bg-blue-100 text-blue-700 font-semibold' : '' %>"
        >
          <span class="sidebar-icon text-xl">ğŸ‘¥</span>
          <span class="sidebar-text">Manajemen User</span>
        </a>
      </li>
      <% } %>

      <% if (user && user.level === 'admin') { %>
      <li>
        <a
          href="/admin/users"
          class="flex items-center gap-3 px-5 py-2 rounded-md
                text-gray-700 hover:bg-blue-100 hover:text-blue-700
                <%= activePage === 'admin-users' ? 'sidebar-active bg-blue-100 text-blue-700 font-semibold' : '' %>"
        >
          <span class="sidebar-icon text-xl">ğŸ‘¥</span>
          <span class="sidebar-text">Manajemen User</span>
        </a>
      </li>
      <% } %>

    </ul>
  </nav>

  <!-- Footer -->
  <div class="mt-auto w-full p-4 border-t border-gray-200">
    <p class="sidebar-text text-xs text-gray-400 transition-all duration-300">
      &copy; <%= new Date().getFullYear() %> IT SERVER BAPENDA KALTENG
    </p>
  </div>
</aside>

<script>
  function toggleSidebar() {
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("sidebar-overlay");

    if (window.innerWidth < 768) {
      sidebar.classList.toggle("sidebar-open");
      overlay.classList.toggle("hidden");
      return;
    }

    // Desktop mini mode
    sidebar.classList.toggle("sidebar-mini");
    document.querySelectorAll(".sidebar-text").forEach((el) => {
      el.classList.toggle("hidden");
    });
    const logo = document.getElementById("sidebar-logo");
    if (logo) logo.classList.toggle("scale-75");
  }


  // Optional: close sidebar on mobile when clicking outside
  document.addEventListener("click", (e) => {
    const sidebar = document.getElementById("sidebar");
    const isSidebar = sidebar.contains(e.target);
    const isToggle = e.target.closest("[onclick='toggleSidebar()']");

    if (!isSidebar && !isToggle && window.innerWidth < 768) {
      sidebar.classList.remove("sidebar-open");
    }
  });
</script>
